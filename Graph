DECLARE @DateFrom	AS DATE = '2019-10-21'
DECLARE @DateTo		AS DATE = '2019-10-27'
DECLARE @Workshop	AS INT	= 600

;WITH DATERANGE AS (
			SELECT
					CAST (@DateFrom AS DATE)	[DateFrom],
					CAST (@DateTo AS DATE)		[DateTo]
),
DATELIST AS	( 
			SELECT 
					DateFrom [DATE],
					DATENAME(WEEKDAY,DateFrom) [DOTW],
					CASE	WHEN DATENAME(WEEKDAY,DateFrom)	= 'Monday'		THEN 0
							WHEN DATENAME(WEEKDAY,DateFrom) = 'Tuesday'		THEN 1
							WHEN DATENAME(WEEKDAY,DateFrom) = 'Wednesday'	THEN 2
							WHEN DATENAME(WEEKDAY,DateFrom) = 'Thursday'	THEN 3
							WHEN DATENAME(WEEKDAY,DateFrom) = 'Friday'		THEN 4
							WHEN DATENAME(WEEKDAY,DateFrom) = 'Saturday'	THEN 5
							WHEN DATENAME(WEEKDAY,DateFrom) = 'Sunday'		THEN 6 
					END							[CYCLE_SEQUENCE_NO]
			FROM	DATERANGE  
			UNION ALL
			SELECT 
					DATEADD(DAY,1,DATE) [DATE] ,
					DATENAME(WEEKDAY,DATEADD(DAY,1,DATE))[DOTW],
					CASE	WHEN DATENAME(WEEKDAY,DATEADD(DAY,1,DATE))	= 'Monday'		THEN 0
							WHEN DATENAME(WEEKDAY,DATEADD(DAY,1,DATE)) = 'Tuesday'		THEN 1
							WHEN DATENAME(WEEKDAY,DATEADD(DAY,1,DATE)) = 'Wednesday'	THEN 2
							WHEN DATENAME(WEEKDAY,DATEADD(DAY,1,DATE)) = 'Thursday'		THEN 3
							WHEN DATENAME(WEEKDAY,DATEADD(DAY,1,DATE)) = 'Friday'		THEN 4
							WHEN DATENAME(WEEKDAY,DATEADD(DAY,1,DATE)) = 'Saturday'		THEN 5
							WHEN DATENAME(WEEKDAY,DATEADD(DAY,1,DATE)) = 'Sunday'		THEN 6 
					END							[CYCLE_SEQUENCE_NO]
			FROM	DATELIST 
			WHERE	 DATEADD(DAY,1,DATE)	<= (SELECT DATETO FROM DATERANGE)
),
TIMESHEET_HOURS AS (
			SELECT  DISTINCT
